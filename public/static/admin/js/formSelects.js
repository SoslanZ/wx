"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=n():"function"==typeof define&&define.amd?define(n):t.layui&&e.define?e.define(["jquery"],function(e){e("formSelects",n())}):t.formSelects=n()}("undefined"==typeof layui?null:layui,window,function(){var e="xm-select",t="xm-select-parent",n="xm-select-input",i="xm-select--suffix",a="xm-select-this",r="xm-select-label",o="xm-select-skin",l="xm-dis-disabled",s="xm-select-dis",c="xm-select-temp",d="xm-select-dl",f="xm-select-hide",u="xm-select-title",p="xm-form-select",h="xm-form-selected",v="xm-select-none",m="xm-select-empty",y="xm-cz",g={},x={on:{},endOn:{},filter:{},maxTips:{},opened:{},closed:{}},k={type:"get",header:{},first:!0,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"},tree:{nextClick:function(e,t,n){n([])},folderChoose:!0,lazy:!0}},b=!1,C=[{icon:"xm-iconfont icon-quanxuan",name:"全选",click:function(e,t){b=!0,t.selectAll(e,!0,!0),b=!1}},{icon:"xm-iconfont icon-qingkong",name:"清空",click:function(e,t){b=!0,t.removeAll(e,!0,!0),b=!1}},{icon:"xm-iconfont icon-fanxuan",name:"反选",click:function(e,t){b=!0,t.reverse(e,!0,!0),b=!1}},{icon:"xm-iconfont icon-pifu",name:"换肤",click:function(e,t){t.skin(e)}}],w=window.$||window.layui&&window.layui.jquery,S=w(window),T={},L={},A={},j=function(t){var n=this;this.config={name:null,max:null,maxTips:function(t,i,a,r){var o=w('[xid="'+n.config.name+'"]').prev().find("."+e);o.parents(".layui-form-item[pane]").length&&(o=o.parents(".layui-form-item[pane]")),o.attr("style","border-color: red !important"),setTimeout(function(){o.removeAttr("style")},300)},init:null,on:null,opened:null,closed:null,filter:function(e,t,n,i){return-1==n.name.indexOf(t)},clearid:-1,direction:"auto",height:null,isEmpty:!1,btns:[C[0],C[1],C[2]],searchType:0,create:function(e,t){return Date.now()},template:function(e,t){return t.name},showCount:0,isCreate:!1,placeholder:"请选择",clearInput:!1},this.select=null,this.values=[],w.extend(this.config,t,{searchUrl:t.isSearch?t.searchUrl:null,placeholder:t.optionsFirst?t.optionsFirst.value?"请选择":t.optionsFirst.innerHTML||"请选择":"请选择",btns:t.radio?[C[1]]:[C[0],C[1],C[2]]},A[t.name]||L),(isNaN(this.config.showCount)||this.config.showCount<=0)&&(this.config.showCount=19921012)},E=function(){this.appender(),this.on(),this.onreset()};E.prototype.appender=function(){Array.prototype.map||(Array.prototype.map=function(e,t){var n,i,a,r=Object(this),o=r.length>>>0;for(t&&(n=t),i=new Array(o),a=0;a<o;){var l,s;a in r&&(l=r[a],s=e.call(n,l,a,r),i[a]=s),a++}return i}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError("this is null or not defined");var a=Object(this),r=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;i<r;){var o;i in a&&(o=a[i],e.call(n,o,i,a)),i++}}),Array.prototype.filter||(Array.prototype.filter=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=[],a=arguments[1],r=0;r<n;r++)if(r in t){var o=t[r];e.call(a,o,r,t)&&i.push(o)}return i})},E.prototype.init=function(a){var l=this;w(a||"select["+e+"]").each(function(a,c){var f=w(c),p=f.attr(e),h=f.next(".layui-form-select"),v=f.next("."+t),m={name:p,disabled:c.disabled,max:f.attr("xm-select-max")-0,isSearch:void 0!=f.attr("xm-select-search"),searchUrl:f.attr("xm-select-search"),isCreate:void 0!=f.attr("xm-select-create"),radio:void 0!=f.attr("xm-select-radio"),skin:f.attr(o),direction:f.attr("xm-select-direction"),optionsFirst:c.options[0],height:f.attr("xm-select-height"),formname:f.attr("name")||f.attr("_name"),layverify:f.attr("lay-verify")||f.attr("_lay-verify"),layverType:f.attr("lay-verType"),searchType:"dl"==f.attr("xm-select-search-type")?1:0,showCount:f.attr("xm-select-show-count")-0},y=f.find("option[selected]").toArray().map(function(e){return{name:e.innerHTML,value:e.value}}),x=new j(m);x.values=y,x.config.init?(x.values=x.config.init.map(function(e){return"object"==(void 0===e?"undefined":_typeof(e))?e:{name:f.find('option[value="'+e+'"]').text(),value:e}}).filter(function(e){return e.name}),x.config.init=x.values.concat([])):x.config.init=y.concat([]),!x.values&&(x.values=[]),g[p]=x,h[0]&&h.remove(),v[0]&&v.remove();var b=l.renderSelect(p,x.config.placeholder,c),C=x.config.height&&"auto"!=x.config.height?'xm-hg style="height: 34px;"':"",S=['<div class="'+r+'">','<input type="text" fsw class="xm-input '+n+'" '+(x.config.isSearch?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"],L=w('<div class="xm-form-select" '+o+'="'+x.config.skin+'">\n\t\t\t\t\t<input class="xm-hide-input" value="" name="'+x.config.formname+'" lay-verify="'+x.config.layverify+'" lay-verType="'+x.config.layverType+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+u+" "+(x.config.disabled?s:"")+'">\n\t\t\t\t\t\t<div class="xm-input '+e+'" '+C+">\n\t\t\t\t\t\t\t"+S.join("")+'\n\t\t\t\t\t\t\t<i class="xm-select-sj"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+i+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+x.config.placeholder+'" readonly="readonly" unselectable="on" class="xm-input">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+p+'" class="'+d+" "+(x.config.radio?"xm-select-radio":"")+'">'+b+"</dl>\n\t\t\t\t</div>"),A=w('<div class="'+t+'" FS_ID="'+p+'"></div>');A.append(L),f.after(A),f.attr("lay-ignore",""),f.removeAttr("name")&&f.attr("_name",x.config.formname),f.removeAttr("lay-verify")&&f.attr("_lay-verify",x.config.layverify),x.config.isSearch?(T[p]=w.extend({},k,{searchUrl:x.config.searchUrl},T[p]),w(document).on("input","div."+t+'[FS_ID="'+p+'"] .'+n,function(e){l.search(p,e,x.config.searchUrl)}),x.config.searchUrl&&l.triggerSearch(L,!0)):L.find("dl dd.xm-dl-input").css("display","none")})},E.prototype.search=function(e,t,n,i){var a=this,r=void 0;if(i)r=i;else{r=t.target;var o=t.keyCode;if(9===o||13===o||37===o||38===o||39===o||40===o)return!1}var s=w.trim(r.value);this.changePlaceHolder(w(r));var c=T[e]?T[e]:k;n=c.searchUrl||n;var d=g[e],u=d.config.isCreate,h=w('dl[xid="'+e+'"]').parents("."+p);if(n){if(c.searchVal&&(s=c.searchVal,c.searchVal=""),!c.beforeSearch||c.beforeSearch&&c.beforeSearch instanceof Function&&c.beforeSearch(e,n,s)){var y=c.delay;c.first&&(c.first=!1,y=10),clearTimeout(d.clearid),d.clearid=setTimeout(function(){h.find("dl > *:not(.xm-select-tips)").remove(),h.find("dd."+v).addClass(m).text("请求中"),a.ajax(e,n,s,!1,null,!0)},y)}}else{h.find("dl ."+f).removeClass(f),h.find("dl dd:not(.xm-select-tips)").each(function(t,n){var i=w(n),r=x.filter[e]||g[e].config.filter;r&&1==r(e,s,a.getItem(e,i),i.hasClass(l))&&i.addClass(f)}),h.find("dl dt").each(function(e,t){w(t).nextUntil("dt",":not(."+f+")").length||w(t).addClass(f)}),this.create(e,u,s);h.find("dl dd:not(.xm-select-tips):not(."+f+")").length?h.find("dd."+v).removeClass(m):h.find("dd."+v).addClass(m).text("无匹配项")}},E.prototype.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},E.prototype.triggerSearch=function(e,t){var i=this;(e?[e]:w("."+p).toArray()).forEach(function(e,a){e=w(e);var o=e.find("dl").attr("xid");(o&&g[o]&&g[o].config.isEmpty||t)&&i.search(o,null,null,0==g[o].config.searchType?e.find("."+r+" ."+n):e.find("dl .xm-dl-input ."+n))})},E.prototype.clearInput=function(e){var i=w("."+t+'[fs_id="'+e+'"]');(0==g[e].config.searchType?i.find("."+r+" ."+n):i.find("dl .xm-dl-input ."+n)).val("")},E.prototype.ajax=function(e,n,i,a,r,o,l,s){var c=this,d=w("."+t+' dl[xid="'+e+'"]').parents("."+p);if(d[0]&&n){var f=T[e]?T[e]:k,u=w.extend(!0,{},f.data);u[f.searchName]=i,w.ajax({type:f.type,headers:f.header,url:n,data:"json"==f.dataType?JSON.stringify(u):u,success:function(t){if("string"==typeof t&&(t=JSON.parse(t)),f.beforeSuccess&&f.beforeSuccess instanceof Function&&(t=f.beforeSuccess(e,n,i,t)),c.isArray(t)){var u={};u[f.response.statusName]=f.response.statusCode,u[f.response.msgName]="",u[f.response.dataName]=t,t=u}t[f.response.statusName]!=f.response.statusCode?d.find("dd."+v).addClass(m).text(t[f.response.msgName]):(d.find("dd."+v).removeClass(m),c.renderData(e,t[f.response.dataName],a,r,o,s),g[e].config.isEmpty=0==t[f.response.dataName].length),l&&l(e),f.success&&f.success instanceof Function&&f.success(e,n,i,t)},error:function(t){d.find("dd[lay-value]:not(.xm-select-tips)").remove(),d.find("dd."+v).addClass(m).text("服务异常"),f.error&&f.error instanceof Function&&f.error(e,n,i,t)}})}},E.prototype.renderData=function(e,n,o,l,s,c){var d=this;if(o)return void this.renderLinkage(e,n,l);if(c)return void this.renderReplace(e,n);var f=w("."+t+' dl[xid="'+e+'"]').parents("."+p),u=T[e]?T[e]:k,h=f.find("."+i+" input");n=this.exchangeData(e,n);var v=[];f.find("dl").html(this.renderSelect(e,h.attr("placeholder")||h.attr("back"),n.map(function(e){var t=w.extend({},e,{innerHTML:e[u.keyName],value:e[u.keyVal],sel:e[u.keySel],disabled:e[u.keyDis],type:e.type,name:e[u.keyName]});return t.sel&&v.push(t),t})));var m=f.find("."+r),y=f.find("dl[xid]");if(s){var x=g[e].values;x.forEach(function(e,t){y.find('dd[lay-value="'+e.value+'"]').addClass(a)}),v.forEach(function(t,n){-1==d.indexOf(x,t)&&(d.addLabel(e,m,t),y.find('dd[lay-value="'+t.value+'"]').addClass(a),x.push(t))})}else v.forEach(function(t,n){d.addLabel(e,m,t),y.find('dd[lay-value="'+t.value+'"]').addClass(a)}),g[e].values=v;this.commonHandler(e,m)},E.prototype.renderLinkage=function(e,i,a){var r=[],o=0,l={0:i},s=T[e]?T[e]:k;D[e]={};do{!function(){var t=r[o++]=[],n=l;l={},w.each(n,function(n,i){w.each(i,function(i,a){var r={pid:n,name:a[s.keyName],value:a[s.keyVal]};D[e][r.value]=w.extend(a,r),t.push(r);var o=a[s.keyChildren];o&&o.length&&(l[r.value]=o)})})}()}while(Object.getOwnPropertyNames(l).length);var c=w("."+t+' dl[xid="'+e+'"]').parents("."+p),d=['<div class="xm-select-linkage">'];w.each(r,function(e,t){var n=['<div style="left: '+(a-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(0!=e?"xm-select-linkage-hide":"")+'">'];w.each(t,function(e,t){var i='<li title="'+t.name+'" pid="'+t.pid+'" xm-value="'+t.value+'"><span>'+t.name+"</span></li>";n.push(i)}),n.push("</div>"),d=d.concat(n)}),d.push('<div style="clear: both; height: 288px;"></div>'),d.push("</div>"),c.find("dl").html(d.join("")),c.find("."+n).css("display","none")},E.prototype.renderReplace=function(e,n){var i=this,a=w("."+t+' dl[xid="'+e+'"]'),r=T[e]?T[e]:k;n=this.exchangeData(e,n),D[e]=n;var o=n.map(function(t){var n=w.extend({},t,{innerHTML:t[r.keyName],value:t[r.keyVal],sel:t[r.keySel],disabled:t[r.keyDis],type:t.type,name:t[r.keyName]});return i.createDD(e,n)}).join("");a.find("dd:not(.xm-select-tips),dt:not([style])").remove(),a.find("dt[style]").after(w(o))},E.prototype.exchangeData=function(e,t){var n=T[e]?T[e]:k,i=n.keyChildren,a=n.keyDis;return D[e]={},this.getChildrenList(t,i,a,[],!1)},E.prototype.getChildrenList=function(e,t,n,i,a){for(var r=[],o=0,l=0;l<e.length;l++){var s=e[l];if(s.type&&"optgroup"==s.type)r.push(s);else{o++;var c=i.concat([]);c.push(o-1+"_E"),s.XM_PID_VALUE=JSON.stringify(c),s[n]=s[n]||a,r.push(s);var d=s[t];if(d&&H.isArray(d)&&d.length){s.XM_TREE_FOLDER=!0;var f=c.concat([]),u=this.getChildrenList(d,t,n,f,s[n]);r=r.concat(u)}}}return r},E.prototype.create=function(e,t,n){if(t&&n){var i=g[e],a=w('[xid="'+e+'"]'),r=a.find("dd.xm-select-tips.xm-dl-input"),o=null,l=a.find("dd."+c);if(a.find("dd:not(.xm-select-tips):not(."+c+")").each(function(e,t){n==w(t).find("span").attr("name")&&(o=t)}),!o){var s=i.config.create(e,n);l[0]?(l.attr("lay-value",s),l.find("span").text(n),l.find("span").attr("name",n),l.removeClass(f)):r.after(w(this.createDD(e,{name:n,innerHTML:n,value:s},c+" xm-select-create-long")))}}else w("[xid="+e+"] dd."+c).remove()},E.prototype.createDD=function(e,t,n){var i=T[e]?T[e]:k,a=w.trim(t.innerHTML);D[e][t.value]=w(t).is("option")?t=function(){var e={};return e[i.keyName]=a,e[i.keyVal]=t.value,e[i.keyDis]=t.disabled,e}():t;var r=g[e].config.template(e,t),o=t.XM_PID_VALUE;o=o?JSON.parse(o):[-1];var s=-1==o[0]?"":'tree-id="'+o.join("-")+'" tree-folder="'+!!t.XM_TREE_FOLDER+'"';return'<dd lay-value="'+t.value+'" class="'+(t.disabled?l:"")+" "+(n||"")+'" '+s+'>\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?l:"")+'"  style="margin-left: '+30*(o.length-1)+'px">\n\t\t\t\t\t\t<i class="xm-iconfont"></i>\n\t\t\t\t\t\t<span name="'+a+'">'+r+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"},E.prototype.createQuickBtn=function(e,t){return'<div class="xm-cz" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"},E.prototype.renderBtns=function(e,t,n){var i=this,a=[],r=w('dl[xid="'+e+'"]');return a.push('<div class="xm-cz-group" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">'),w.each(g[e].config.btns,function(e,t){a.push(i.createQuickBtn(t,n))}),a.push("</div>"),a.push(this.createQuickBtn({icon:"xm-iconfont icon-caidan",name:""})),a.join("")},E.prototype.renderSelect=function(e,t,i){var a=this;D[e]={};var r=[];return g[e].config.btns.length?(setTimeout(function(){var t=w('dl[xid="'+e+'"]');t.parents("."+p).attr("xm-select-search-type",g[e].config.searchType),t.find(".xm-cz-group").css("max-width",t.prev().width()-54+"px")},10),r.push(['<dd lay-value="" class="xm-select-tips" style="background-color: #FFF!important;">',this.renderBtns(e,null,"30px"),"</dd>",'<dd lay-value="" class="xm-select-tips xm-dl-input" style="background-color: #FFF!important;">','<i class="xm-iconfont icon-sousuo"></i>','<input type="text" class="xm-input '+n+'" placeholder="请搜索"/>',"</dd>"].join(""))):r.push('<dd lay-value="" class="xm-select-tips">'+t+"</dd>"),this.isArray(i)?w(i).each(function(t,n){n&&(n.type&&"optgroup"===n.type?r.push("<dt>"+n.name+"</dt>"):r.push(a.createDD(e,n)))}):w(i).find("*").each(function(t,n){("option"!=n.tagName.toLowerCase()||0!=t||n.value)&&("optgroup"===n.tagName.toLowerCase()?r.push("<dt>"+n.label+"</dt>"):r.push(a.createDD(e,n)))}),r.push('<dt style="display:none;"> </dt>'),r.push('<dd class="xm-select-tips '+v+" "+(2===r.length?m:"")+'">没有选项</dd>'),r.join("")},E.prototype.on=function(){var e=this;this.one(),w(document).on("click",function(n){w(n.target).parents("."+u)[0]||(w("."+t+" dl ."+f).removeClass(f),w("."+t+" dl dd."+m).removeClass(m),w("."+t+" dl dd."+c).remove(),w.each(g,function(t,n){e.clearInput(t),n.values.length||e.changePlaceHolder(w('div[FS_ID="'+t+'"] .'+r))})),w("."+t+" ."+h).each(function(t,n){e.changeShow(w(n).find("."+u),!1)})})},E.prototype.calcLabelLeft=function(e,t,n){var i=this.getPosition(e[0]);i.y=i.x+e[0].clientWidth;var a=e[0].offsetLeft;if(e.find("span").length)if(n){var r=e.find("span:last");r="none"==r.css("display")?r.prev()[0]:r[0];var o=this.getPosition(r);o.y=o.x+r.clientWidth,a=o.y>i.y?a-(o.y-i.y)-5:0}else if(t<0){var l=e.find(":last");l="none"==l.css("display")?l.prev()[0]:l[0];var s=this.getPosition(l);s.y=s.x+l.clientWidth,s.y>i.y&&(a-=10)}else a<0&&(a+=10),a>0&&(a=0);else a=0;e.css("left",a+"px")},E.prototype.one=function(t){var i=this;w(t||document).off("click","."+u).on("click","."+u,function(t){var a=w(t.target),r=a.is(u)?a:a.parents("."+u),o=r.next(),c=o.attr("xid");if(w("dl[xid]").not(o).each(function(e,t){i.clearInput(w(t).attr("xid"))}),w("dl[xid]").not(o).find("dd."+f).removeClass(f),r.hasClass(s))return!1;if(a.is(".xm-select-sj")||a.is("."+n+"[readonly]"))return i.changeShow(r,!r.parents("."+p).hasClass(h)),!1;if(r.find("."+n+":not(readonly)")[0]){var d=r.find("."+n),v={x:t.pageX,y:t.pageY},m=i.getPosition(r[0]);for(r.width();v.x>m.x;){if(w(document.elementFromPoint(v.x,v.y)).is(d))return d.focus(),i.changeShow(r,!0),!1;v.x-=50}}if(a.is("."+n))return i.changeShow(r,!0),!1;if(a.is('i[fsw="'+e+'"]')){var y=i.getItem(c,a),g=o.find("dd[lay-value='"+y.value+"']");return!g.hasClass(l)&&(i.handlerLabel(c,g,!1,y),!1)}return i.changeShow(r,!r.parents("."+p).hasClass(h)),!1}),w(t||document).off("click","dl."+d).on("click","dl."+d,function(e){var t=w(e.target);if(t.is(".xm-select-linkage")||t.parents(".xm-select-linkage")[0]){t=t.is("li")?t:t.parents("li[xm-value]");var n=t.parents(".xm-select-linkage-group"),r=t.parents("dl").attr("xid");if(!r)return!1;n.find(".xm-select-active").removeClass("xm-select-active"),t.addClass("xm-select-active"),n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var o=n.next(".xm-select-linkage-group");if(o.find("li").addClass("xm-select-linkage-hide"),o.find('li[pid="'+t.attr("xm-value")+'"]').removeClass("xm-select-linkage-hide"),o[0]&&0!=o.find("li:not(.xm-select-linkage-hide)").length)o.removeClass("xm-select-linkage-hide");else{var s=[],c=0,d=!t.hasClass("xm-select-this");g[r].config.radio&&t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this");do{s[c++]={name:t.find("span").text(),value:t.attr("xm-value")},t=t.parents(".xm-select-linkage-group").prev().find('li[xm-value="'+t.attr("pid")+'"]')}while(t.length);s.reverse();var f={name:s.map(function(e){return e.name}).join("/"),value:s.map(function(e){return e.value}).join("/")};i.handlerLabel(r,null,d,f)}return!1}if(t.is("dl"))return!1;if(t.is("dt"))return t.nextUntil("dt").each(function(e,t){t=w(t),t.hasClass(l)||t.hasClass(a)||t.find("i:not(.icon-expand)").click()}),!1;var u=t.is("dd")?t:t.parents("dd"),p=u.parent("dl").attr("xid");if(u.hasClass(l))return!1;if(t.is("i.icon-caidan")){var h=[],v=[];t.parents("dl").find('dd[tree-folder="true"]').each(function(e,t){void 0==w(t).attr("xm-tree-hidn")?h.push(t):v.push(t)});return(v.length?v:h).forEach(function(e){return e.click()}),!1}var m=u.attr("tree-id");if(m){if(t.is("i:not(.icon-expand)"))return i.handlerLabel(p,u,!u.hasClass(a)),!1;var x=T[p]||k,b=x.tree,C=u.nextAll('dd[tree-id^="'+m+'"]');if(C&&C.length){var S=C[0].clientHeight;return S?(i.addTreeHeight(u,S),S=0):(S=u.attr("xm-tree-hidn")||36,u.removeAttr("xm-tree-hidn"),u.find(">i").remove(),C=C.filter(function(e,t){return w(t).attr("tree-id").split("-").length-1==m.split("-").length})),C.animate({height:S},150),!1}if(b.nextClick&&b.nextClick instanceof Function)return b.nextClick(p,i.getItem(p,u),function(e){if(e&&e.length){u.attr("tree-folder","true");var t=[];e.forEach(function(e,n){e.innerHTML=e[x.keyName],e.XM_PID_VALUE=JSON.stringify(m.split("-").concat([n])),t.push(i.createDD(p,e)),D[p][e[x.keyVal]]=e}),u.after(t.join(""))}else i.handlerLabel(p,u,!u.hasClass(a))}),!1}if(u.hasClass("xm-select-tips")){var L=t.is("."+y)?t:t.parents("."+y);if(!L[0])return!1;var A=L.attr("method"),j=g[p].config.btns.filter(function(e){return e.name==A})[0];return j&&j.click&&j.click instanceof Function&&j.click(p,i),!1}return i.handlerLabel(p,u,!u.hasClass(a)),!1})},E.prototype.addTreeHeight=function(e,t){var n=this,i=e.attr("tree-id"),a=e.nextAll('dd[tree-id^="'+i+'"]');a.length&&(e.append('<i class="xm-iconfont icon-expand"></i>'),e.attr("xm-tree-hidn",t),a.each(function(e,i){var a=w(i);n.addTreeHeight(a,t)}))};var D={};E.prototype.getItem=function(t,n){if(n instanceof w){if(n.is('i[fsw="'+e+'"]')){var i=n.parent();return D[t][n]||{name:i.find("font").text(),value:i.attr("value")}}var a=n.attr("lay-value");return D[t][a]?D[t][a]:D[t][a]={name:n.find("span[name]").attr("name"),value:a}}return"string"==typeof n&&-1!=n.indexOf("/")?D[t][n]||{name:this.valToName(t,n),value:n}:D[t][n]},E.prototype.linkageAdd=function(e,t){var n=w('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var i=t.value.split("/"),a=void 0,r=void 0,o=0,l=[];do{a=i[o],r=n.find(".xm-select-linkage-group"+(o+1)+' li[xm-value="'+a+'"]'),r[0]&&l.push(r),o++}while(r.length&&void 0!=a);l.length==i.length&&w.each(l,function(e,t){t.addClass("xm-select-this")})},E.prototype.linkageDel=function(e,t){var n=w('dl[xid="'+e+'"]'),i=t.value.split("/"),a=void 0,r=void 0,o=i.length-1;do{a=i[o],r=n.find(".xm-select-linkage-group"+(o+1)+' li[xm-value="'+a+'"]'),r.parent().next().find("li[pid="+a+"].xm-select-this").length||r.removeClass("xm-select-this"),o--}while(r.length&&void 0!=a)},E.prototype.valToName=function(e,t){var n=w('dl[xid="'+e+'"]'),i=(t+"").split("/");if(!i.length)return null;var a=[];return w.each(i,function(e,t){var i=n.find(".xm-select-linkage-group"+(e+1)+' li[xm-value="'+t+'"] span').text();a.push(i)}),a.length==i.length?a.join("/"):null},E.prototype.commonHandler=function(t,n){n&&n[0]&&(this.checkHideSpan(t,n),this.changePlaceHolder(n),this.retop(n.parents("."+p)),this.calcLabelLeft(n,0,!0),this.setHidnVal(t,n),n.parents("."+u+" ."+e).attr("title",g[t].values.map(function(e){return e.name}).join(",")))},E.prototype.initVal=function(e){var t=this,n={};e?n[e]=g[e]:n=g,w.each(n,function(e,n){var i=n.values,o=w('dl[xid="'+e+'"]').parent(),l=o.find("."+r),s=o.find("dl");s.find("dd."+a).removeClass(a);var c=i.concat([]);c.concat([]).forEach(function(n,i){t.addLabel(e,l,n),s.find('dd[lay-value="'+n.value+'"]').addClass(a)}),n.config.radio&&c.length&&i.push(c[c.length-1]),t.commonHandler(e,l)})},E.prototype.setHidnVal=function(e,n){n&&n[0]&&n.parents("."+t).find(".xm-hide-input").val(g[e].values.map(function(e){return e.value}).join(","))},E.prototype.handlerLabel=function(e,t,n,i,o){var s=w('[xid="'+e+'"]').prev().find("."+r),d=t&&this.getItem(e,t),f=g[e].values,p=g[e].config.on||x.on[e],h=g[e].config.endOn||x.endOn[e];i&&(d=i);var v=g[e];if(n&&v.config.max&&v.values.length>=v.config.max){var m=x.maxTips[e]||g[e].config.maxTips;return void(m&&m(e,f.concat([]),d,v.config.max))}if(!(!o&&p&&p instanceof Function&&0==p(e,f.concat([]),d,n,t&&t.hasClass(l)))){var y=w('dl[xid="'+e+'"]');n?(t&&t[0]?(t.addClass(a),t.removeClass(c)):y.find(".xm-select-linkage")[0]&&this.linkageAdd(e,d),this.addLabel(e,s,d),f.push(d)):(t&&t[0]?t.removeClass(a):y.find(".xm-select-linkage")[0]&&this.linkageDel(e,d),this.delLabel(e,s,d),this.remove(f,d)),s[0]&&(v.config.radio&&this.changeShow(s,!1),s.parents("."+u).prev().removeClass("layui-form-danger"),v.config.clearInput&&this.clearInput(e),this.commonHandler(e,s),!o&&h&&h instanceof Function&&h(e,f.concat([]),d,n,t&&t.hasClass(l)))}},E.prototype.addLabel=function(t,n,i){if(i){var r='fsw="'+e+'"',o=[w("<span "+r+' value="'+i.value+'"><font '+r+">"+i.name+"</font></span>"),w("<i "+r+' class="xm-iconfont icon-close"></i>')],l=o[0],s=o[1];l.append(s);var c=g[t];c.config.radio&&(c.values.length=0,w('dl[xid="'+t+'"]').find("dd."+a+':not([lay-value="'+i.value+'"])').removeClass(a),n.find("span").remove()),n.find("input").css("width","50px"),n.find("input").before(l)}},E.prototype.delLabel=function(e,t,n){n&&t.find('span[value="'+n.value+'"]:first').remove()},E.prototype.checkHideSpan=function(t,n){n.parents("."+e)[0].offsetHeight;n.find("span.xm-span-hide").removeClass("xm-span-hide"),n.find("span[style]").remove();var i=g[t].config.showCount;n.find("span").each(function(e,t){e>=i&&w(t).addClass("xm-span-hide")});var a=n.find("span:eq("+i+")");a[0]&&a.before(w('<span style="padding-right: 6px;" fsw="'+e+'"> + '+(n.find("span").length-i)+"</span>"))},E.prototype.retop=function(t){var n=t.find("dl"),i=t.offset().top+t.outerHeight()+5-S.scrollTop(),a=n.outerHeight(),r=t.hasClass("layui-form-selectup")||-1!=n.css("top").indexOf("-")||i+a>S.height()&&i>=a;t=t.find("."+e);var o=g[n.attr("xid")],l=n.parents(".layui-form-pane")[0]&&n.prev()[0].clientHeight>38?14:10;(o&&"up"==o.config.direction||r)&&(r=!0,o&&"down"==o.config.direction&&(r=!1));var s=t[0].offsetTop+t.height()+l;r?n.css({top:"auto",bottom:s+3+"px"}):n.css({top:s+"px",bottom:"auto"})},E.prototype.changeShow=function(e,i){w(".layui-form-selected").removeClass("layui-form-selected");var a=e.parents("."+p),o=a.hasClass(h),l=a.find("dl").attr("xid");if(w("."+t+" ."+p).not(a).removeClass(h),i?(this.retop(a),a.addClass(h),a.find("."+n).focus(),a.find("dl dd[lay-value]:not(.xm-select-tips)").length||a.find("dl ."+v).addClass(m)):(a.removeClass(h),this.clearInput(l),a.find("dl ."+m).removeClass(m),a.find("dl dd."+f).removeClass(f),a.find("dl dd."+c).remove(),l&&g[l]&&g[l].config.isEmpty&&this.triggerSearch(a),this.changePlaceHolder(a.find("."+r))),i!=o){var s=g[l].config.opened||x.opened[l];i&&s&&s instanceof Function&&s(l);var d=g[l].config.closed||x.closed[l];!i&&d&&d instanceof Function&&d(l)}},E.prototype.changePlaceHolder=function(a){var r=a.parents("."+u);if(r[0]||(r=a.parents("dl").prev()),r[0]){var o=a.parents("."+t).find("dl[xid]").attr("xid");if(g[o]&&g[o].config.height);else{var l=r.find("."+e)[0].clientHeight;r.css("height",(l>36?l+4:l)+"px");var s=r.parents("."+t).parent().prev();s.is(".layui-form-label")&&r.parents(".layui-form-pane")[0]&&(l=l>36?l+4:l,r.css("height",l+"px"),s.css({height:l+2+"px",lineHeight:l-18+"px"}))}var c=r.find("."+i+" input");if(!a.find("span:last")[0]&&!r.find("."+n).val()){var d=c.attr("back");c.removeAttr("back"),c.attr("placeholder",d)}else{var f=c.attr("placeholder");c.removeAttr("placeholder"),c.attr("back",f)}}},E.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].value==t||e[n].value==(t?t.value:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t))return n;return-1},E.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.value:t);return n>-1&&(e.splice(n,1),!0)},E.prototype.selectAll=function(e,t,n){var i=this,r=w('[xid="'+e+'"]');r[0]&&(r.find(".xm-select-linkage")[0]||r.find("dd[lay-value]:not(.xm-select-tips):not(."+a+")"+(n?":not(."+l+")":"")).each(function(n,a){a=w(a);var o=i.getItem(e,a);i.handlerLabel(e,r.find('dd[lay-value="'+o.value+'"]'),!0,o,!t)}))},E.prototype.removeAll=function(e,t,n){var i=this,a=w('[xid="'+e+'"]');if(a[0])return a.find(".xm-select-linkage")[0]?void g[e].values.concat([]).forEach(function(e,t){var n=e.value.split("/"),i=void 0,r=void 0,o=0;do{i=n[o++],r=a.find(".xm-select-linkage-group"+o+':not(.xm-select-linkage-hide) li[xm-value="'+i+'"]'),r.click()}while(r.length&&void 0!=i)}):void g[e].values.concat([]).forEach(function(r,o){n&&a.find('dd[lay-value="'+r.value+'"]').hasClass(l)||i.handlerLabel(e,a.find('dd[lay-value="'+r.value+'"]'),!1,r,!t)})},E.prototype.reverse=function(e,t,n){var i=this,r=w('[xid="'+e+'"]');r[0]&&(r.find(".xm-select-linkage")[0]||r.find("dd[lay-value]:not(.xm-select-tips)"+(n?":not(."+l+")":"")).each(function(n,o){o=w(o);var l=i.getItem(e,o);i.handlerLabel(e,r.find('dd[lay-value="'+l.value+'"]'),!o.hasClass(a),l,!t)}))},E.prototype.skin=function(e){var n=["default","primary","normal","warm","danger"],i=n[Math.floor(Math.random()*n.length)];w('dl[xid="'+e+'"]').parents("."+t).find("."+p).attr("xm-select-skin",i),this.check(e)&&this.commonHandler(e,w('dl[xid="'+e+'"]').parents("."+t).find("."+r))},E.prototype.getPosition=function(e){for(var t=0,n=0;null!=e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:t,y:n}},E.prototype.onreset=function(){w(document).on("click","[type=reset]",function(e){w(e.target).parents("form").find("."+t+" dl[xid]").each(function(e,t){var n=t.getAttribute("xid"),i=w(t),a=void 0,r={};H.removeAll(n),g[n].config.init.forEach(function(e,t){e&&(!r[e]||g[n].config.repeat)&&(a=i.find('dd[lay-value="'+e.value+'"]'))[0]&&(H.handlerLabel(n,a,!0),r[e]=1)})})})},E.prototype.bindEvent=function(e,t,n){t&&t instanceof Function&&(n=t,t=null),n&&n instanceof Function&&(t?g[t]?(g[t].config[e]=n,delete x[e][t]):x[e][t]=n:w.each(g,function(t,i){g[t]?g[t].config[e]=n:x[e][t]=n}))},E.prototype.check=function(e,t){return!!w('dl[xid="'+e+'"]').length||(w('select[xm-select="'+e+'"]').length?t?void 0:(this.render(e,w('select[xm-select="'+e+'"]')),!0):(delete g[e],!1))},E.prototype.render=function(e,n){H.init(n),H.one(w('dl[xid="'+e+'"]').parents("."+t)),H.initVal(e)},E.prototype.log=function(e){console.log(e)};var N=function(){this.v="4.0.0.0910",this.render()},H=new E;return N.prototype.value=function(e,t,n){if("string"!=typeof e)return[];var i=g[e];if(!H.check(e))return[];if("string"==typeof t||void 0==t){var a=i.values.concat([])||[];return"val"==t?a.map(function(e){return e.value}):"valStr"==t?a.map(function(e){return e.value}).join(","):"name"==t?a.map(function(e){return e.name}):"nameStr"==t?a.map(function(e){return e.name}).join(","):a}if(H.isArray(t)){var r=w('[xid="'+e+'"]'),o={},l=void 0,s=!0;0==n?s=!1:1==n?s=!0:H.removeAll(e),s&&i.values.forEach(function(e,t){o[e.value]=1}),t.forEach(function(t,n){if(t&&(!o[t]||i.config.repeat))if((l=r.find('dd[lay-value="'+t+'"]'))[0])H.handlerLabel(e,l,s,null,!0),o[t]=1;else{var a=H.valToName(e,t);a&&(H.handlerLabel(e,l,s,H.getItem(e,t),!0),o[t]=1)}})}},N.prototype.on=function(e,t,n){return H.bindEvent(n?"endOn":"on",e,t),this},N.prototype.filter=function(e,t){return H.bindEvent("filter",e,t),this},N.prototype.maxTips=function(e,t){return H.bindEvent("maxTips",e,t),this},N.prototype.opened=function(e,t){return H.bindEvent("opened",e,t),this},N.prototype.closed=function(e,t){return H.bindEvent("closed",e,t),this},N.prototype.config=function(e,n,i){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&(i=1==n,n=e,e=null),n&&"object"==(void 0===n?"undefined":_typeof(n))&&(i&&(n.header||(n.header={}),n.header["Content-Type"]="application/json; charset=UTF-8",n.dataType="json"),e?(T[e]=w.extend(!0,{},T[e]||k,n),!H.check(e)&&this.render(e),g[e]&&n.direction&&(g[e].config.direction=n.direction),g[e]&&n.clearInput&&(g[e].config.clearInput=!0),n.searchUrl&&g[e]&&H.triggerSearch(w("."+t+' dl[xid="'+e+'"]').parents("."+p),!0)):(w.extend(!0,k,n),w.each(T,function(e,t){w.extend(!0,t,n)}))),this},N.prototype.render=function(n,i){var a;n&&"object"==(void 0===n?"undefined":_typeof(n))&&(i=n,n=null);var o=i?(a={init:i.init,disabled:i.disabled,max:i.max,isSearch:i.isSearch,searchUrl:i.searchUrl,isCreate:i.isCreate,radio:i.radio,skin:i.skin,direction:i.direction,height:i.height,formname:i.formname,layverify:i.layverify,layverType:i.layverType,showCount:i.showCount,placeholder:i.placeholder,create:i.create,filter:i.filter,maxTips:i.maxTips,on:i.on},_defineProperty(a,"on",i.on),_defineProperty(a,"opened",i.opened),_defineProperty(a,"closed",i.closed),_defineProperty(a,"template",i.template),_defineProperty(a,"clearInput",i.clearInput),a):{};return i&&void 0!=i.searchType&&(o.searchType="dl"==i.searchType?1:0),n?(A[n]={},w.extend(A[n],g[n]?g[n].config:{},o)):w.extend(L,o),w(w("select["+e+'="'+n+'"]')[0]?"select["+e+'="'+n+'"]':"select["+e+"]").each(function(n,i){var a=i.getAttribute(e);H.render(a,i),setTimeout(function(){return H.setHidnVal(a,w('select[xm-select="'+a+'"] + div.'+t+" ."+r))},10)}),this},N.prototype.disabled=function(e){var t={};return e?H.check(e)&&(t[e]=g[e]):t=g,w.each(t,function(e,t){w('dl[xid="'+e+'"]').prev().addClass(s)}),this},N.prototype.undisabled=function(e){var t={};return e?H.check(e)&&(t[e]=g[e]):t=g,w.each(t,function(e,t){w('dl[xid="'+e+'"]').prev().removeClass(s)}),this},N.prototype.data=function(e,t,n){return e&&t&&n?H.check(e)?(this.value(e,[]),this.config(e,n),"local"==t?H.renderData(e,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"):"server"==t&&H.ajax(e,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"),this):(H.log("id: "+e+" not render !!!"),this):(H.log("id: "+e+" param error !!!"),this)},N.prototype.btns=function(e,t,n){if(e&&H.isArray(e)&&(t=e,e=null),!t||!H.isArray(t))return this;var a={};return e?H.check(e)&&(a[e]=g[e]):a=g,t=t.map(function(e){if("string"==typeof e){
    if("select"==e)return C[0];if("remove"==e)return C[1];if("reverse"==e)return C[2];if("skin"==e)return C[3]}return e}),w.each(a,function(e,a){a.config.btns=t;var r=w('dl[xid="'+e+'"]').find(".xm-select-tips:first");if(t.length){var o=n&&n.show&&("name"==n.show||"icon"==n.show)?n.show:"",l=H.renderBtns(e,o,n&&n.space?n.space:"30px");r.html(l)}else{var s=r.parents("."+p).find("."+i+" input"),c=s.attr("placeholder")||s.attr("back");r.html(c),r.removeAttr("style")}}),this},N.prototype.search=function(e,t){return e&&H.check(e)&&(T[e]=w.extend(!0,{},T[e]||k,{first:!0,searchVal:t}),H.triggerSearch(w('dl[xid="'+e+'"]').parents("."+p),!0)),this},N.prototype.replace=function(e,t,n){var i=this;if(!e||!t||!n)return H.log("id: "+e+" param error !!!"),this;if(!H.check(e,!0))return H.log("id: "+e+" not render !!!"),this;var a=this.value(e,"val");this.value(e,[]),this.config(e,n),"local"==t?(H.renderData(e,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100",!1,!0),this.value(e,a,!0)):"server"==t&&H.ajax(e,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100",!1,function(e){i.value(e,a,!0)},!0)},N.prototype.isBatch=function(){return this.batch=b,this},new N});